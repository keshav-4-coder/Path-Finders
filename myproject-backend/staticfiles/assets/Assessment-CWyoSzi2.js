import{a as e,f as t,i as n,l as r,o as i}from"./index-Dlr-tsx4.js";var a=t(r()),o=t(e());function s(){let{user:e}=(0,a.useContext)(n);(0,a.useEffect)(()=>{console.log(`AuthContext user:`,e)},[e]);let[t,r]=(0,a.useState)([{sender:`bot`,text:`Hello ${e?.name||`User`}! I'm your AI career mentor. Tell me about your interests!`}]),[s,c]=(0,a.useState)(``),[l,u]=(0,a.useState)(!1),[d,f]=(0,a.useState)({name:e?.name||`User`,interest:e?.interests||`general`}),p=(0,a.useRef)(null);(0,a.useEffect)(()=>{p.current&&(p.current.scrollTop=p.current.scrollHeight)},[t]),(0,a.useEffect)(()=>{f({name:e?.name||`User`,interest:e?.interests||`general`})},[e]);let m=async()=>{let e=s.trim();if(!(!e||l)){r(t=>[...t,{sender:`user`,text:e}]),c(``),r(e=>[...e,{sender:`bot`,text:`Thinking...`}]),u(!0);try{let t=await i.post(`http://127.0.0.1:8000/chat/api/chat/`,{message:e,userProfile:d},{timeout:3e4,headers:{"Content-Type":`application/json`}});if(t.data.success)console.log(`API userProfile response:`,t.data.userProfile),t.data.userProfile&&f(t.data.userProfile),r(e=>[...e.slice(0,-1),{sender:`bot`,text:t.data.response}]);else throw Error(t.data.error||`Unknown error`)}catch(e){console.error(`API Error:`,e);let t=e.response?.data?.error||e.message||`Unable to connect`;r(e=>[...e.slice(0,-1),{sender:`bot`,text:`Error: ${t}`}])}finally{u(!1)}}};return(0,o.jsxs)(`div`,{className:`chatbot-container`,children:[(0,o.jsxs)(`div`,{className:`chat-header`,children:[(0,o.jsx)(`h2`,{children:`AI Mentor`}),(0,o.jsxs)(`div`,{className:`user-info`,children:[(0,o.jsx)(`div`,{className:`user-avatar`,children:(e=>e.split(` `).map(e=>e[0]?.toUpperCase()).join(``).slice(0,2))(d.name)}),(0,o.jsxs)(`span`,{children:[d.name,` (`,d.interest,`)`]})]})]}),(0,o.jsx)(`div`,{className:`chat-box`,ref:p,children:t.map((e,t)=>(0,o.jsx)(`div`,{className:`message-wrapper ${e.sender}`,children:(0,o.jsx)(`div`,{className:`chat-message ${e.sender}-message`,children:(0,o.jsx)(`div`,{className:`message-content`,children:e.text})})},t))}),(0,o.jsx)(`div`,{className:`chat-input-area`,children:(0,o.jsxs)(`div`,{className:`input-wrapper`,children:[(0,o.jsx)(`textarea`,{className:`chat-input`,placeholder:`Ask about career paths or interests...`,value:s,onChange:e=>c(e.target.value),onKeyPress:e=>{e.key===`Enter`&&!e.shiftKey&&(e.preventDefault(),m())},disabled:l,rows:`2`}),(0,o.jsx)(`button`,{className:`btn-send ${l?`loading`:``}`,onClick:m,disabled:l||!s.trim(),children:l?`...`:`âž¤`})]})})]})}export{s as default};